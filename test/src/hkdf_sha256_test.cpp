#include <gtest/gtest.h>
#include <gtest_custom_assertions.h>
#include <hex.hpp>
#include <cstring>
#include <utility>
#include <vector>
extern "C" {
#include <hkdf.h>
#include <sha256.h>
}
namespace {

class InputHashPair {
public:
	const std::string name;
	const std::vector<uint8_t> salt;
	const std::vector<uint8_t> ikm;
	const std::vector<uint8_t> info;
	const std::vector<uint8_t> expected_prk;
	const std::vector<uint8_t> expected_okm;

	template<size_t N>
	static std::vector<uint8_t> to_vector(const std::array<uint8_t, N> &input) {
		std::vector<uint8_t> vector(input.data(), &input.data()[N]);
		return vector;
	}

	template<size_t N>
	static std::vector<uint8_t> to_vector(const char (&input)[N]) {
		std::vector<uint8_t> vector(input, &input[N - 1]);
		return vector;
	}

	template<
		typename SaltType,
		typename IkmType,
		typename InfoType,
		typename ExpectedPrkType,
		typename ExpectedOkmType
	>
	InputHashPair(
		std::string name,
		const SaltType &salt,
		const IkmType &ikm,
		const InfoType &info,
		const ExpectedPrkType &expected_prk,
		const ExpectedOkmType &expected_okm
	) :
		name(std::move(name)),
		salt(to_vector(salt)),
		ikm(to_vector(ikm)),
		info(to_vector(info)),
		expected_prk(to_vector(expected_prk)),
		expected_okm(to_vector(expected_okm)) {}

};

class HkdfSha256Test : public testing::TestWithParam<InputHashPair> {

};

TEST_P(HkdfSha256Test, ExtractProducesCorrectPrk) {

	const auto &salt = GetParam().salt;
	const auto &ikm = GetParam().ikm;
	const auto &expected_prk = GetParam().expected_prk;

	ASSERT_EQ(expected_prk.size(), LIONKEY_SHA256_OUTPUT_SIZE);

	uint8_t prk[expected_prk.size()];

	const hash_alg_t *hash_alg = &hash_alg_sha256;

	const size_t hmac_sha256_ctx_size = hmac_get_context_size(hash_alg);

	ASSERT_GT(hmac_sha256_ctx_size, 0);

	uint8_t hmac_sha256_ctx[hmac_sha256_ctx_size];
	hkdf_extract(
		hash_alg,
		hmac_sha256_ctx,
		salt.data(), salt.size(),
		ikm.data(), ikm.size(),
		prk
	);

	EXPECT_SAME_BYTES_S(expected_prk.size(), prk, expected_prk.data());

}

TEST_P(HkdfSha256Test, HkdfProducesCorrectOkm) {

	const auto &salt = GetParam().salt;
	const auto &ikm = GetParam().ikm;
	const auto &info = GetParam().info;
	const auto &expected_okm = GetParam().expected_okm;

	// Variable length arrays of length 0 are not allowed by the C standard.
	// Therefore, we add 1 to the size (which might be 0).
	// We do that always to avoid the need for an if statement (branch),
	// which is usually slower than just always allocating a slightly bigger array.
	uint8_t okm[expected_okm.size() + 1];

	hkdf(
		&hash_alg_sha256,
		salt.data(), salt.size(),
		ikm.data(), ikm.size(),
		info.data(), info.size(),
		expected_okm.size(),
		okm
	);

	EXPECT_SAME_BYTES_S(expected_okm.size(), okm, expected_okm.data());

}

INSTANTIATE_TEST_SUITE_P(
	Rfc5869TestVectorsSha256,
	HkdfSha256Test,
	testing::Values(
		// see https://datatracker.ietf.org/doc/html/rfc5869#appendix-A
		InputHashPair(
			"TestCase1",
			hex::bytes<"000102030405060708090a0b0c">(),
			hex::bytes<"0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b">(),
			hex::bytes<"f0f1f2f3f4f5f6f7f8f9">(),
			hex::bytes<
				"077709362c2e32df0ddc3f0dc47bba63"
				"90b6c73bb50f9c3122ec844ad7c2b3e5"
			>(),
			hex::bytes<
				"3cb25f25faacd57a90434f64d0362f2a"
				"2d2d0a90cf1a5a4c5db02d56ecc4c5bf"
				"34007208d5b887185865"
			>()
		),
		InputHashPair(
			"TestCase2",
			hex::bytes<
				"606162636465666768696a6b6c6d6e6f"
				"707172737475767778797a7b7c7d7e7f"
				"808182838485868788898a8b8c8d8e8f"
				"909192939495969798999a9b9c9d9e9f"
				"a0a1a2a3a4a5a6a7a8a9aaabacadaeaf"
			>(),
			hex::bytes<
				"000102030405060708090a0b0c0d0e0f"
				"101112131415161718191a1b1c1d1e1f"
				"202122232425262728292a2b2c2d2e2f"
				"303132333435363738393a3b3c3d3e3f"
				"404142434445464748494a4b4c4d4e4f"
			>(),
			hex::bytes<
				"b0b1b2b3b4b5b6b7b8b9babbbcbdbebf"
				"c0c1c2c3c4c5c6c7c8c9cacbcccdcecf"
				"d0d1d2d3d4d5d6d7d8d9dadbdcdddedf"
				"e0e1e2e3e4e5e6e7e8e9eaebecedeeef"
				"f0f1f2f3f4f5f6f7f8f9fafbfcfdfeff"
			>(),
			hex::bytes<
				"06a6b88c5853361a06104c9ceb35b45c"
				"ef760014904671014a193f40c15fc244"
			>(),
			hex::bytes<
				"b11e398dc80327a1c8e7f78c596a4934"
				"4f012eda2d4efad8a050cc4c19afa97c"
				"59045a99cac7827271cb41c65e590e09"
				"da3275600c2f09b8367793a9aca3db71"
				"cc30c58179ec3e87c14c01d5c1f3434f"
				"1d87"
			>()
		),
		InputHashPair(
			"TestCase3",
			hex::bytes<"">(),
			hex::bytes<"0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b">(),
			hex::bytes<"">(),
			hex::bytes<
				"19ef24a32c717b167f33a91d6f648bdf"
				"96596776afdb6377ac434c1c293ccb04"
			>(),
			hex::bytes<
				"8da4e775a563c18f715f802a063c5a31"
				"b8a11f5c5ee1879ec3454e5f3c738d2d"
				"9d201395faa4b61a96c8"
			>()
		)
	),
	[](const testing::TestParamInfo<HkdfSha256Test::ParamType> &info) {
		return info.param.name;
	}
);

INSTANTIATE_TEST_SUITE_P(
	OkmLengthTestVectorsSha256,
	HkdfSha256Test,
	testing::Values(
		InputHashPair(
			"OkmLength0",
			hex::bytes<"">(),
			hex::bytes<
				"379bfa2f6a272d73dafb5f02c5489e2c"
				"8a6869171b4320e2c3b0459d95488cc9"
			>(),
			"OkmLength0",
			hex::bytes<
				"1252194637ebb686d1a48629ce8eded6"
				"39b2bc8494b95ed95068c5b602933d47"
			>(),
			hex::bytes<
				""
			>()
		),
		InputHashPair(
			"OkmLength1",
			hex::bytes<"">(),
			hex::bytes<
				"acafc6f318b950a6b309e8a92e31bd42"
				"f757fdd83247db2a715b9c10186ee839"
			>(),
			"OkmLength1",
			hex::bytes<
				"563f36d7bbae9a25c5e605cee78297a5"
				"c72e636d2917d05578a5a35cf4f9ca80"
			>(),
			hex::bytes<
				"39"
			>()
		),
		InputHashPair(
			"OkmLength32",
			hex::bytes<"">(),
			hex::bytes<
				"1a4770044196dff93265f2a2f518cbad"
				"83147ffbdb1b1d6f168af2af52062f4e"
			>(),
			"OkmLength32",
			hex::bytes<
				"98dd1185301963ee9d7f078fdf1a9312"
				"e60005d804d1ab2cdbef8c2fe8f77724"
			>(),
			hex::bytes<
				"47d42e3a76e9db94e122816af61b4577"
				"b6a1d95892dc86c5f2faa5ecd5c8cb41"
			>()
		),
		InputHashPair(
			"OkmLength33",
			hex::bytes<"">(),
			hex::bytes<
				"63636a1217320bb9a03715755d559087"
				"1b4ae3ebb704d415a63c9af5686a7970"
			>(),
			"OkmLength33",
			hex::bytes<
				"14ce45803c627dcc0f2f524e5fcfe026"
				"7661b6de4adb48741fe1228b4dfff670"
			>(),
			hex::bytes<
				"bfd70812c78951fd4f18343a4b8705c9"
				"926f1322c464f764faa623a559c7c671"
				"b9"
			>()
		),
		InputHashPair(
			"OkmLength64",
			hex::bytes<"">(),
			hex::bytes<
				"e8c20073f84c7ca0b4f81ddad7b84f1d"
				"e2fd320e8df42cf05aafb44749be493e"
			>(),
			"OkmLength64",
			hex::bytes<
				"8cf3c4a6fec2a4789a6926a53464f28d"
				"579922c7a2d7180f54c3e0d0f1c9cb6a"
			>(),
			hex::bytes<
				"39a66e25ab2ce19f7fc9e67f2dcd76f1"
				"dfff51ac2a9950cb69196dd05b67f19c"
				"1e9568974ac5f4eb70dabd3a736e54ab"
				"3e460a0e014412fc96270d20b2a96ced"
			>()
		),
		InputHashPair(
			"OkmLength65",
			hex::bytes<"">(),
			hex::bytes<
				"9fa75c653cf1c8d92dadf505c1b81a86"
				"af5640b0091d91bdada8a3b18c62e27c"
			>(),
			"OkmLength65",
			hex::bytes<
				"77b300d99ecf6dc72df75bfa4fe86fba"
				"a0d87815791c79318bd99dedbf3dcd57"
			>(),
			hex::bytes<
				"c3e55fe387653c37515281565fc7519f"
				"9ab4971ca2314ebdabc6082cfd54f582"
				"1d237ee07626c3d6ea8f11ab55a50fd6"
				"09697f59402bcc0e4a266b7d3e1a5187"
				"61"
			>()
		),
		InputHashPair(
			"OkmLength8160",
			hex::bytes<"">(),
			hex::bytes<
				"5757311eb189531e4d664e76968672d9"
				"1f9325043720d6d6ebb29585c90f7ac4"
			>(),
			"OkmLength8160",
			hex::bytes<
				"b51a6e11cdbe5058c4bd3330922f5cdd"
				"4213f9011598615381d9cf72ce99fe9b"
			>(),
			hex::bytes<
				"453c3c479a929319467984584334eb8a64512f8509e693b47f677ef9c46c6dbbeb3a857583738149bd55985cee908b8de75efee5d41af29b8fc88c8097bf7cf76b8c1cb2d5262c7c7e4ac7b33b51d3fe6be87eb50f49755293ce2cf28ce337798a325514e64a386ba8c1c0a5e8a9cd36297a61cc913317d3773b3fd0293c4787db53ce45e83587db7a8f91529c1ed017471ef40d521bf8860a2ba040a317108a5b40d033dbf6c52af4f7b407360d65c41eecb2e9632afe5a6db26ad87fead5762e01f20ca4697940d70b02cc0b722b2c4b3b5b95fa459bb0a3116789a7afd570f26c58990be60c0dd619a3e1eea8024728c0b16e5ab4d5cf6802b061a01c7caddd09194e459a16997efedb896652e899bd5208f74eca42b4f3a0a7f3c34c668c295a6a181699d5c8e4c1e62758df9e0bf41b6ac77106280a6bde271b1bdb924e7e82556658bb8b86ec566e0a6f18d4b72fff2e686739d8530432bd17b8aa3168f35c7e71d02858dbbd0c3a4d5759eacbe19a4cdafa617ad512f74c2410b4171aca99025172a899548582d5cd0446a175dcc91e8b4f20ae8814d430f05ed46a2cda297ccef3b7e90b665cc9987d8ea3c964eb85fa05e01d6644e2ac5a135b7dbf9b4699c4fdb28d9de294a05690468034d3d8a9ef6c0fcb1acf8b8bca98523b5ec2dca9761ca68054ab70297d5d86c1ac3f2f6d78a290e92012412e7dd65f6a482769cd40241cca4bdb3d9578011f7fe73f456b52364b7f0df7fa8be0b77fb334aa6a62ec2e6fe035ca00457bba035eb7555e0a13688221c28e17d5e85ab6fad6d0fc1146a4384108a123585e1d0952ea2b2edb37f233ab29ca03287845b7cc4b49701d08f414492d30d31f8d0c8ff45912cbff3bd0f812423d7f9f2e556cced56393988095feba95a299601067a730e2ed7580da8d51f371ad5e0c9b07d78a50db6c627414f0a6fe96e7c72668a6b978cab22dc5c86ab18737480305876c5413c88a4a53e8b28291778a3874df58d39c9b1723c326c88b36b0b11504303bdc73ad8a053c53bab1b1a5a07c73ddcfe2dd247a85ab56881ba7a9153218b8cc0d5de7db07b913c2f61c6bfbfb460cb88e2cf1b78528ce8d550b880b0dd5a2837a44c6bfd47f1dc6ab292dc9470a025e8b20c12a43a97c7e5e692a0e9b94b9b50f4350579d6ddec794774642da784053b3e57e2736132cbbd779de7f68ea90172e979f169eb44231e1509df97296885b8d5c2e93f4f08de09182644144d8db0ecab7939016f7219f8c9cf5b3b3d4a9fb38a98b16a7923bb361d006683912cdcb0aedd35abdb76c39dd17dde6f4fb48d0e5f2210684fdee482b0963f0117165d54071cc2b68d98b02164c30f4db794105ae71365a98c648bcd2b22a1d7f7646de566f66f13f37e56b7fb604a5a7920f88016cbc871c8768f9136845ce7a0d8766893f4eadd0e50cb0fbec873f11e4f9b83a6d88344c912e1d197503b9fc29fbb31b0bc3cc8654530757456e9ad0d0965de7c33b7bc51f27fd8e17eb924ef134c1c02903fed08943a195e1bb25031827bcc1a91159c42d67c9a495574aebbde27cb4c89c0f35d2d3b8c9be3c83497674e31e5ec90ea88829d27a882fd0a6ccec126d05712082f295cd7f674ba11cabf075341a2e17cbaeec2b0eb513009aa04ca90d9d2524fa0175b9edd4c7aea930ac78c9fd3059608111531fb18cda06ef982b39357e4077562f02bbb749cab43ec9f39f84dbaf587522d1fcec9d415c665eab0c4120def6dff6925deb66a1d34449be77be8cde900607ae131e550d0a6a0b4f37facd732c419764d439e232a4ce51470816024ed65e62eeb0d3330d6936c1b0758c1b44195b3a0141b4a6a14fb88889ab1a6ac53986b485b740fa71a3e07f85d86bfd724d110e289df4392ac6334591c8b42b5f8ec7726c087bfc63f07de8fb4417ea73ae499a3bc636dd5983d2c9a98cd9a8e5636d21e8ebb4b952535d0021d6dfb906caccadc0287692c1eed73b41a59fc74f56e8228d944d7469144876d3a371567d54f29206bdc4dfc673024dfbbb952816ba645f31d6b074c77cb14e909f6f74a6ea79276d7da80da7094426e6f77d1a1ef399df6258607e95c55f5d92bb24108ccbc9720a39decc8908df259742d4c02a18d98ba209652588dc472619961b76d300282ba2d27f79cb7ac32a90ed8d48fc11873b5b98ae25db03e6dbd162d2dc4d7e8efd56efd45f16d19625d67e8284c12026843852c69e1203913457998904b186a8d61ee1ae2ea2648fb2bd5dc1cfecf280dd3acde15000f8550f5cc85dcedad1ffa1ba44fd3b0ce8fec9be367cf85f3cca22806b531b8dbf05f1c12cf67106b1cc7861206105ad84525fc32ce69ce5c44572c84a76e562b812263574bed4cba933ef956c82fc75d6f8e15a4c0cfef7a8b1863046f09f1e90e1428842e601e768aeedb124761f9d0a2dc0fb8f15636e44ce8c98dee47b52bc83d2f518e423219cb664079f11401c57229cf7f2eb866ff1b82e40b44d07ed3ba651ec2339b2248e3769a06fdfa3eb427ee002db6524e495ce189f0df0fe09e79b42d8f29166f4c7eaac018181d30ade705067c24ceef99a1d77b1dda2da8fdc881adc9cdc07a2ddb13b88dfea31469742e6e2a816f4e9347228d6705f7326dcc3c81d36226abf0d6595eecf23d4d41d041861179da543cd0941ba07788030acb25a4e1c7bc47c8dc36b1144cedf1169fc966694ae9815a636d4d9b11494d7fcc4a079508b8d116096bda7e3e590cc08c4b6388dc3990931a96f255ac5a6974bb408f9f930dbbcd748c5a4b875cd0ac26b14b60f70ea6843c033d6998a8d2a0efb9559795ebc2e0fd0827918a44a4c6df559ee1437a943c811f2de3160622fdb09b6135d5ef3f602b5e08d77c6e2d1ed661d43fe3d79b0524dec89958a2e98cc00c9f67f220de60764862e941dd4d77ed6fdf9f1f57340fe0cf5ca09f26d5200305d37d1ca3603d12de51b806b54fda7b11030647777a726f126ee2bbcad2436ddf7df99229fcd9f69ad7f36d9c510b53b5d0d6dee8e8282719ca033820a427997da3af616878c5473cab6987835602609d0b10c92d86a5d0d2a49d299026ac97d917abe9af75b53b78ae6965c8a24e96b05c4571d2f4969a4871f5e18ea0acdab91e06ce770615c45d9fc1f8a88f5be969ce89b00e1fc4b83bf5b9aec6fbff641a4367d9911a835ef353ff0f603e19871e5ac1909be1c986ce5ca31215b27591ab28925e4fd9bf65e54b9f61d5e5e572d2f7e698d4f82ba08f60671342266ee9bcbca3ca714ba7d6852dc321df619cdd0ca90ffaecb3602ea84d253c178849c172cc8aae5ae857c079f1537afa726c431bf41f07733975fefe4f288c996791e927e94223d7db1bc1764dd611272d2682eac702bd5368f1747fa8dcc5a932b23bc1c427eb77c56892270a88f1904e2182dcd62fb39124b123a1c5fd3aec2820213c21eb8c1bb64171af0f032cb345f16b81f1a4a2c657da3833a87dfdba4a990d530944ed52a54f0f9d04bf1921c49145de7a12b17862054692043c0abcb885986564475701e9f97aff99d4f103c091f88415a84cc9fdb13be3931207af87561f874d3474c0c1efd31785dadacec4c2764d7647b74b43689cbbce433c5d325258be958626c740dbe0888a07b493e476e6d97799b0ae0b82502b6ce32e375a0f3b53f7d1a24597f418731c97122b5395eb1609c64cec1e209d338ff43af9683d8bfa26e6a8db6ec8300497ead3cbb3e1dc5568b651ea2e5cddd242e1d7673da2907fe51900ed8501fc33ee4ad0f54375386006199abd30196413116919d1462279ad9e83300bf42c3973ff01a74f355745292887a26fbe611022e3b03dc6d38fabfdf03a287cd966955130f7dfeaf9e5bc5411dc8943304b9d939a16d7452afe219ce82e3360bac63724f35017e8b55b63c772d88ddeb0579a30fda0dce54fcb0312d88d1371d032010e8751bbd20c5bca0872d91667d52376a2929a6b24a04b18f2cc6df64a64f383f723d252503d81c0296f7fbdac393e6907ab8abf96de0a6e922112b24e6f0e8e4789bc603b77a73866f830e682f4a0ac4ce49777e58c5f79bdc012862ef2d37aa564fafd8cc15a6f3966f4e33fc45ac8d659e239cbe93af2c4e5fcd3eb886bd4ab9c7f803b3ef51f00f6c6aaed26ae60e1f3885b54c039009d0e3c043a4f5e048230a22a07f93c57fbc30ad0c7efd15c1dc027e2b238d1d6acb266db3a10bb732ccc587e8f47d01e1d53f3bfc64c79bfc9c50e25442327f5482d3e6377082dfa5a3fed1ba79817c66dcc6f56c045196d585836df2d6265a2dbc8b00f7daa852843c5ed8a7e64a2f93efa37fe0581bd680c5f56b0dba010911afca12f4efdf9bb6c8ca9f1ffe446a1c92650529646f2ca80974dbb848e20ef7437ae2bde59521fccd3ec35c6d51a3a6aac6a4c7f967c71542acec761790cb86a566833ebd452258701c7cd4acf63432bca75a8f85aa6edbef8a52a5fc19182a13167889c346a0d5e6fa9fffd2a71c21f4ebd923d91ee550f7784bbf1f8b4a921a731bf079d5d6fe08c53d9952f91e5f0aa9cd1fed0e903ac59c17d52460b46c78f532855624f59af3c8465de431c9ea2764b69d957982e405af5afc1562fcc0f16cff33b6a10a581f163ee3a580ee9c1dea1d62fa425db21034a8b495b9d6c900a990eb4dee85bd45eec0b1b9e0e15c3f952228f918cc3b4de0566c0e2e04754af692b007fa24d6e49ab35f781d658abcec723692ca6042ab275cea953bf50b06afc133a7ee571db683d15c38b167ffb8ca0311827d724675e8bb13d733d34ce2087d7602012b6f784bd0d89b01cfaac15f79c5d49f7dabe74e9fe3c3a3883a7eb61ea7f96385d87794ad54af5221b3c65409c2436ffd40a17459c8583b4417f1db39a1a1d5e01d96a5b26bd7e876df54d6eec86b6760c5c879f2e5521d24676727d11919f9d48a7b792242ee8181dc712949e74ab5e842a26bdc76928ac1a160e22d89cb530034aca7be7bfedf91d6b4e23e078dc611276a319018384d658ae3f56847b5980996a190cb6817b0750b0b6b2bef9bc3ef7eb50a1d6e825f7402f92680241bf577f6a5ca5f475e65fcf86a939945e459685572dcabd2b0eae7e2eac88f0fa89eaad97d30b5eede9a09f5f59028c0dacb3bf2a301c7c032724aed17dc842af3ffe227687f59abf5ea8d67955559b8a1a414aa4ee82bc40384b71ec96ba6c66e8b64efa7a569a0d4f10d37e1ed3868cbbe721a1a4b0a4b26f4bc1d379d3087758f0dae3d389ee70a6c59987610c43f1b07efed1f81079770bf31fd389ebb893abb1a114cdde08db8bff4222a442031badbe0d2126d9253e132af9e520f703163ccf1908ee4b54a5fd05535616fcc9a3adfb959ebf1a278b57d1a3c17d7ddddc5b2b89a8c00d1011e57fe550aa06cc1d1398638fd3a0404468afb2d5ec8b45a8734b7bdfdb90f1742980b2f4bd14337f49c82e0d3f511c94b6e412685642123a17a5fc6bcb1be3eb560731a2d076ff9c4d5166b77f11802ee614f205e8d0c0ab43eb2489c2c0718c048f051e7bb4d6417edbc62763d77006bc58c3f44df3487fc0c2aadd7acbd28d6ba62d63a7c9d78abe421fd19883b78b7fb3da9fa2c43cceb3f4d29a24a4f18d6b1f7cd7da42a9f59b978d1179c9b56922d619f170afdbd98ae0f6a13ac0eabe89ec799ac81a04c9f283fea46ff158b76f01e61f4bd986a6275f526b3d401712e4dbfc505d6715cd6bfed2d3270bfb85094b04ceb3c74fc789dc0b7c4611f6de703c2e813e26f951954a0226ce57705244e423b624ec09bee7bfbf3c8697053df278301db66a58ea8583868b8c71ee5eb48b0ab63341086325261bf8e75074a45b745bc48b039e96e2e097a1d0f49c2787a6de2d77d2934409e4a86f4e540a59e90ff260cc827a0f3cc31d3976198e2000a652b861dd0b3cf0dc6a21b5d5a2869346fa691fdfde4a1ee72e8ac59c048fe178202290f29c1be874446d2e60e1af45749d4864be5cd193c44fdfc5902ebf8666f8adf9f9274a38172059883ef306ac5280c13f109c71853d7f869323184cadc89b176c42010ece4d3a33a5fe8d4d9d60a2dd03fb7176a36103c18541a5bc5edf46070217902c1178bcf0e198f34df1754297f646908e9d46548164c2a3e398e31fcecca1d25d9e8c76008e74179bd2b5bc9f4f0abc0806c73d401586755fb1f7ad5218e8fb384346f3faf248cf241fab32b90f2056b3a75dec9a3bda675734d2f680117ec50b8aa3935514dd3ccded15c1fb32d27ce31aa584104e079a5844beb99c74f0486af70ce2ebe91856225582955dca32716c4d01c45fdd69c6462e0c4e10723010bb254c06cc4e35277bf447215bc6869812edd0651ea0d203a10a72da1e1005483ebb2f620b9733a2f37a0e728f9ce35649bc7dcd154e8e8df0379233806033c0cd50e6fac1afd73fbbbf97c3f205ce54d013e5865d744db93d0c12e0a07e6ecc65d37792cf7e012fa0a997c8eedfea4b4e24feaa09fa61e9d3d1e0a3398a2031143584c272ea564e78a28e622ef3239aab77a6e628df7041762e36048d440a937e50b5b676da6b03e0039332d3c1ada0da94fb5310e2542bbc992f031a13d64636782ffaf91893ee909b6e4ceabc159c7290e46654c4355e938dbcb1012d777c0e89022112a67b103fef52142f76f6acfce42f7404d8c45d5fae7504f17bb772ef2bf2fdeb3d01a7f3e3198b4ebc8686933994be3d530276f69d4b7f89e2a744424c8973c045ad121f0b683d69a4d14f686be32d4652385b22687b18061bfe50ea09c285dd9eb88c29842f38332c38d22a1548f5282afc1440ee57468c8758c03a534d1fd485923732ca558dbb368cb6dd64ae405990b1e56e69cd2b96e29fffa2dfe493a80766a530cd86eba20de7fb0a3e1aebe55878c7f4edaa68691b8b5c3a7ff9dbed4d5897e9060bd281d53e9b396dfb84447148aeeb0a60788ecd1e1a6ffee03f0d327552a0f2ff3686da100c05e089bd76883596f97f946b78a8695b19956215fce01eac19723297b2b4b8d5415220f533ada070bc192fc2b87cadc9ed4c139464caa692a67ca7dbd5796b4610337066a9ed390085709c93abc30d068d6dcd5524ebd28d275b3885a6c5d7af47a9cb67573a9f8aef6daff0ecb28d228b2f6dc1462889c9791870af6a777f3ba898416524af32b6dc8135b61a9e97371ae84510fc1839d3e025d9c850a3d39a530c3252c9cf5cf543f6b30a650facdf3dda07660b95a53e2a657aed601cbb8edc1b117e0bd107c46bf5579f719ce6654bb0f30d49910f39407d92f403ca691afde881afc3991cd74113cbe3d2665cfe7134824f39fd11834030ad8ba68251c3d19c0b13214ee6da55b01c7a902906c63c6dadb62e0af3b826eacde6bd548f3e964a052b42422769b7cf66ee7159196b40a897acf0207acd0863a4aba151a5a2ab147274cc663b8de6e09162516a7b0f3b885d40381631619c9d12192276b82c38d062b104a1a9b66c560001a1fd449ab245cd72ad4d08259d912eb97e66979c8b0b3e45265cd829a85d7ae1eb0a4ed6eda3501fa06c39016fa51805b9fd4bdb55e95b4434a782ab1ee7b50af6501db5068ca70a04b501a3c37b214db6d87ba9c4714b1795922310a878e025b9224cdcdaaa018e04eafcc29281b3bf1adbc8c41b948e5229e1f11165e7117c51922256e4124fea2a3aa7b9c32474d11e2751257da28ef0b795c690fe184e360c48e85c5f76187e9749b85db61087c544c3a9e0e986793b7685904ca18a4d4a63b019a244c776edf221343bcbc450be2a9e187fd17c61247eb0535dca682084ebe6ee9cfc7acfb53487abd2ec4b85e8b97531cb0fb5a995bda4342851ef996d563e1935b246816bdd087073a13be0365b5d4c5b92ed0dff9f5dac3945cf493f7f545f0db9c6588a09051b025cd3cf11969e3ab69a7a898d5890b05464a25e7fdd1c6ccd80523ec67f715dbeeda8a3b4e80f05521cd94b0c837f600aeb01ace7d739568811c9f43e66c0e5e9e88e684f6835e1c49284344a3ad342096f25919fed15eddf9615e6ca31030523b360771385fe2b98c565d9194c3de1d7d12e67e42118b93fd7b06c21086e2b3b59f72828cf3be1ecc8f60a7f18dfb187b161f0e3f52f59f977198485266f7303efd199167789f386193c7c2be6ee033874fe9438deaf71ef6d03d00f18bf541167db6d6e2d51ea17ab0a288c0cc5b1d41e18c24bec3df1c18b196f85d41d5d116266fbf54aa0e611320cdbf5373e3398fb590eb125034ee3355780f2e5f45a0514f5b3c1fc35e6546bcf3bd52821d24273afa3f25cea9f83a9aef89b5b58aeba3a7b87d165dba2cc22cbd2eb16349bf15ee885e07a0365ea461f0707b9f10a961891c7a060872603416ac6f9c6ee7e986aceaa7e75f726518dc07336ddab678056831c6062556a84e4db01638e599d27e417a6d18651414bd297f47a64982162b98aa4b39a7df3a4331d2b7eaf18275a414ae83758a39a0d68476239d3412caca935a34247024b2b5447197a46df71276db4acf59ceb23c24929808aa263a26e9f723b889c980129f706902d41cfec3fce492161e2725578a2e1042b4b008f0fe86613a854e79d7a89e999531b424e81a353935a52fdb78260dad4eec242dbdd5ea1785e4a9d416adcd77b8dd326722b45e79411df8725faf9691dc40a8730216518d723be3658481199de4c80cea0642d983369b9a994dc48b3ae18599fc4613f52e542d3d31d2c1b210e47daf410d19597c4da1429901346f39116b24bfbe6ca402a196201ac7eef174b93f58f84377947c1479b21d81b0ebdfae89f7ac9cbe36e41fdc833c5a7a7830229616fc3ae074484d946ff77482d37365ea403a9d3f51bc4cdcccf1983a6dabdf02c4bfeab0b376e5ec9accf3ba1e7f0150be12951779da016266c1891313892ba8cf0ef70c3bb257e96da99065ace5829dc7eb83ebda07c8249a1af307925976af4ca45106d778d4a5e26265e98d75f7a4dd03bdca9a89b12742107364fd79c75ca33623f45b494d04129680975c4997968eeefadb70e2b299b4e871f425e927cce94ffd0b196a7addf3fd77489f4e0b3953b56f5ea206812930d5c3802af1fd800749612a486b94f8e2e8ec0ff8cd1264577c62bf5adb20434e489b396304bc7522db13a998c202a91428a02311efdb6e03674552d35e7d6d453baa59e3b6fecd87a8ac6175e42590dd6e39cd4cca7294c5f5890db651d8343a43a2143b458724a43f08f2624600adedfedfc53360e3d8f07968def848ac30ac105d09af371bda4021d4d37a414f981cea97e1466db10e0659236698e27a88b5e51ccf05b993a0b59e8e8924d018e3577b5a855b66072465f2b6a6c004ac59d210ae9bd40a825252c7ad059b6c8b1191df8d74307f6b65811b144bf32c377494a28868d9743e2b8d1f7689785b7d25d35621ba1e11c040b57e78ef6086eb53ecac5d14f4d42c41e9ac52b76c564abbfd927efdde73e5f822ef996c608dd73dd5404e4807f7a41fff05f120bf1735d9a90da178531712c5c25954784d9b879d06fb69cb044a8223ce773d4c101a6316b2852325aca8b8c0b9134a70158a5df3660c31ffa368293b728dc38fc232637df5f7ef95164b375f408e78b20db7411509074df2f765f601a618f159d6d356b4c8222148882ef7dd8ecd9089f8f41f340c971f1f682642a8a811fdc62b79782321a5bae00e94e6b82ee7cdce0dc19d40d261b2afc6d56bef40b42bbc8cb43dade88aa5bb0a1b16902e5cc2b0487af8584636c42fb4e3403c7f6b1a8feae174310ca115472807e32fd90f9dbfbe8f1b0877eb03ba5e35b44220a6885dd8b13e6ee842c82a924d0202a1f1b54c9d3a6b836aba21ff9b188e171bbfead2917727562572754be9db7629ebbf9f4a3c3cb2554b7b4a12923c46cc7b772666c1002c0bb51433b31d068bf0318abfbf70d831481d1778388ea9533135e59f56ff764e8b54c13803ad17946b1f1db97755029db2ed38da20d882246aa8e39a5d70a31849946061f5fa1ce5eb69178adc49965f7b0e62e9aaab5b2a8ededad18125ff9b234d5187c28ef89dea79593f10be7d68c42960edd36e9b36ba3fe3027d28c9a6b244810f1e134f42133dd5c8a9abd45f4d30852e7e9def78cbaeccda03a51bb17c361ec5d414549647043115a2acc618fa5906b303a7d8ad4464afb7c33bf2f5554020d2d347917f79924e9934d5a19358cc4e2aaaa69bf98f0ef29c7872f3cbdc92d384da9ca7a02ac1cee1eda1af9a0424ef4f019fc1564c647a40a7870425598e07387b488ac2d62d51ea9597494e33c5a3d1dd70221b4fc4a69b77f207512b60c695778232f913f611212a81582c7f811731e37554b100b5eba64c8cd03d1d0577a092a3f97d125a5b29c4dbf65ed5897695e790c37354bd3e827e12a257bd46491888a22d89e46262dc10823fc13fb01e343843400ba44ccb7c05cc473471d309e3d5e02c24974026c2424227ed7156f8e7e629b4d5f4296fac46f4541539d87b42b77a0dad13da69e516203b626d79a90fd140c94da2223b8f504e058afbb86334341a72bcddf9cd100bacead96a455e7b6f997213426df4051a0328e5b5eab69f49cb68c26d68eae89b1038053cdad33fe8da6d98ce5a5cfe1fc359098ab96d1050d0c29240e2e29ecd58a60c04f7610f5701adf58db523e4dca6ff5891b5ae4ddc1094868ac98c8ef357487641c6505a155dc3f3310d43547cfaa85dbe142300044facbfd86235c12afe69c39626c813173ab3c965c36c9305a8aa57db66d6630af3bf95bf9fd60f28c707460732cc697b10c2b344f431792fb75db5889b1687a63a04a5843596a2ad2ee142104598104fdca77d30abc56904df7cee86b99a25d6280dcf15d6dd61bdfe3d9a03e6528d9d8c7b925657827b1fb943a18277adefecf17c2c5a093f6c42a7030fd58874a9c675dad5de92394c18504d043af42cd8152b536a06d6992af956bdcb6a8881e63001dee7a39b7f5fb96ce172203ccdf985df677c976224cc27f71b553e8dff376d3869f7dc0adfb45890284ee7eb37fb7fbc5517f8816503cfb40effe355657daa4ed8d46cc60714d8b816db44975f4dfb6b722921594ad9eb22b7bee0bdcc58db6e8c1e4c2d71d8c63a54d9eb210a2266b4b218cd5139f350cb73347e91180287d77aedb93b1a01ee95609bfeccacb9ce3814c78f7a65f7d4ff4b77e27ba0799264725cc55632fa366540be856e6cf1978f40d8d48d7814b48dae86cecf52fecad0e2b99a2c0183b1c15cb32e241eb2c198bb056f218b03b01b73137990826692aadca5c045f870798ff1cad0506f0570d0c4182371bf727cada607d6bf74275f0cc3abd9703f925f0f5f68b7bdf0dfa4579f52e0e1bf279150091c472c6161b39b173ebcc26d613c2d6834ef0f1e1c4adc4d49e4f8f0212676b72422b143dae085c4a23dfd1a35f404f4a0181c69e611"
			>()
		)
	),
	[](const testing::TestParamInfo<HkdfSha256Test::ParamType> &info) {
		return info.param.name;
	}
);

}
